box: kkarczmarczyk/node-yarn:latest

build:
  steps:
    - bashaus/yarn-install:
      name: Install app dependencies

    - script:
      name: Style guide check
      code: yarn lint

    - script:
      name: Unit test
      code: yarn test:unit

    - script:
      name: deploy
      code: yarn deploy

    - script:
      name: Cleanup
      code: |
        rm -rf ./node_modules
        rm ./yarn.lock

deploy:
  steps:
    - bashaus/yarn-install:
      name: Install app dependencies

    - script:
      name: Build production assets
      code: yarn build

    - script:
      name: deploy
      code: |
        echo $AWS_ACCESS_KEY_ID
        echo $AWS_SECRET_ACCESS_KEY
        yarn deploy
